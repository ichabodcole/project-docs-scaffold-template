# Migration: v2.0–v2.2 → v2.3

## Summary

v2.3 adds the **Design Resolution** document type — an optional stage between
Proposal and Plan that resolves behavioral, structural, and architectural
ambiguity before development planning begins. It also adds the **Handoff**
document type for deployment steps (introduced in v2.1 but without a migration
guide).

**Why this changed:** Proposals that are directionally clear but contain
unresolved system-level questions led to speculative plans and
mid-implementation rework. Design resolution formalizes the convergence step
that was previously done informally. Handoff addresses the gap where some
projects need deployment coordination beyond merging code.

## What's New

| File/Directory                                     | Purpose                                                |
| -------------------------------------------------- | ------------------------------------------------------ |
| `projects/TEMPLATES/DESIGN-RESOLUTION.template.md` | Template for design resolution documents               |
| `projects/TEMPLATES/HANDOFF.template.md`           | Template for deployment handoff documents (since v2.1) |

## What Moved

Nothing moves in this migration.

## What's Removed

Nothing is removed in this migration.

## Step-by-Step Migration

### 1. Generate v2.3 scaffold locally

```bash
cookiecutter gh:ichabodcole/project-docs-scaffold-template -o .scaffold-tmp
```

### 2. Copy new templates

```bash
SCAFFOLD=".scaffold-tmp/<project-name>/docs"

# Copy new templates (only if they don't already exist)
[ ! -f docs/projects/TEMPLATES/DESIGN-RESOLUTION.template.md ] && \
  cp "$SCAFFOLD/projects/TEMPLATES/DESIGN-RESOLUTION.template.md" \
     docs/projects/TEMPLATES/DESIGN-RESOLUTION.template.md

[ ! -f docs/projects/TEMPLATES/HANDOFF.template.md ] && \
  cp "$SCAFFOLD/projects/TEMPLATES/HANDOFF.template.md" \
     docs/projects/TEMPLATES/HANDOFF.template.md
```

### 3. Update docs/projects/README.md

Replace your `docs/projects/README.md` with the scaffold's version:

```bash
cp "$SCAFFOLD/projects/README.md" docs/projects/README.md
```

Review the copied file — the key additions are:

- `design-resolution.md` in the project folder structure example (marked
  optional)
- A "What Goes Where" entry for `design-resolution.md` and `handoff.md`
- A "Design Resolutions" subsection with when-to/when-not-to guidance
- Updated Templates list at the bottom

If you've customized your `projects/README.md`, merge the new sections manually
instead of overwriting.

### 4. Update docs/README.md

The main `docs/README.md` has several changes. You can either replace it from
the scaffold and re-customize, or apply these changes manually:

**4a. Decision flowchart** — Add an optional "Unresolved system behavior, data,
or architecture?" decision diamond between "Create PROJECT folder with
proposal.md" and "Ready to implement?"

**4b. Documentation cycle** — Update the pipeline string:

```
# Before
Report → Investigation → Project (proposal → plan → sessions) → Report

# After
Report → Investigation → Project (proposal → [design-resolution] → plan → sessions) → Report
```

**4c. Quick Reference** — Update the Project entry to mention design resolution:

```markdown
- **Project:** "Here's the full story of building X — proposal, design
  resolution (optional), plan, sessions, artifacts in one place."
```

**4d. Special cases** — Add:

```markdown
- **Proposal has unresolved system-level questions?** → Design resolution before
  planning
```

**4e. Update version** — Update the `docs_version` frontmatter to match the
target version.

### 5. Clean up scaffold

```bash
rm -rf .scaffold-tmp
```

## Verification

```bash
# New templates should exist
ls docs/projects/TEMPLATES/DESIGN-RESOLUTION.template.md
ls docs/projects/TEMPLATES/HANDOFF.template.md

# projects/README.md should reference design resolution
grep "design-resolution" docs/projects/README.md

# docs/README.md should reference design resolution in the cycle
grep "design-resolution" docs/README.md

# Version marker should be updated
grep "docs_version" docs/README.md
```

## Checklist

- [ ] Generated v2.3 scaffold locally via cookiecutter
- [ ] Copied `DESIGN-RESOLUTION.template.md` to `projects/TEMPLATES/`
- [ ] Copied `HANDOFF.template.md` to `projects/TEMPLATES/` (if missing)
- [ ] Updated `docs/projects/README.md` with design resolution and handoff
      sections
- [ ] Updated `docs/README.md` decision flowchart
- [ ] Updated `docs/README.md` documentation cycle string
- [ ] Updated `docs/README.md` Quick Reference and Special cases
- [ ] Updated `docs_version` frontmatter
- [ ] Removed `.scaffold-tmp/` directory
- [ ] Verified new templates and references exist
